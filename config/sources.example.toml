[global]
base_data_dir = "~/substudy-data"
# Prefer cookies.txt for automation to avoid macOS keychain password prompts.
# Generate/update once: yt-dlp --cookies-from-browser chrome --cookies ~/.local/share/substudy/cookies.txt "https://www.tiktok.com"
# cookies_file = "~/.local/share/substudy/cookies.txt"
cookies_from_browser = "chrome"
video_format = "bv*+ba/best"
sub_langs = "en.*,en,und"
sub_format = "vtt/ttml/best"
sleep_interval = 2
max_sleep_interval = 6
retry_sleep = 5
playlist_end = 200
break_on_existing = false
break_per_input = false
lazy_playlist = false

# Older-post backfill (reverse incremental)
backfill_enabled = false
# backfill_start defaults to playlist_end + 1 when unset
# backfill_start = 201
backfill_window = 200
backfill_windows_per_run = 1

# ASR (subtitles from speech recognition)
asr_enabled = false
asr_max_per_run = 20
asr_timeout_sec = 0
asr_prefer_exts = ["srt", "vtt"]
# asr_command = [
#   "python3",
#   "-m", "whisper",
#   "--task", "transcribe",
#   "--language", "en",
#   "--model", "turbo",
#   "--device", "cpu",
#   "--output_dir", "{work_dir}",
#   "--output_format", "srt",
#   "{input_path}",
# ]
ledger_db = "data/master_ledger.sqlite"
ledger_csv = "data/master_ledger.csv"

[[sources]]
id = "example_creator"
platform = "tiktok"
url = "https://www.tiktok.com/@example_creator"
enabled = true

# Paths can be absolute or relative. Relative paths are resolved from data_dir.
data_dir = "example_creator"
media_dir = "media"
subs_dir = "subs"
meta_dir = "meta"
media_archive = "archives/media.archive.txt"
subs_archive = "archives/subs.archive.txt"
urls_file = "archives/urls.txt"
video_id_regex = "_(\\d{10,})_"
asr_dir = "asr"

# Optional overrides:
# handle = "example_creator"
# video_url_template = "https://www.tiktok.com/@{handle}/video/{id}"
# break_on_existing = true
# break_per_input = true
# lazy_playlist = true
# playlist_end = 300
# backfill_enabled = true
# backfill_start = 301
# backfill_window = 300
# backfill_windows_per_run = 2
# asr_enabled = true
